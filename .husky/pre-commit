#!/bin/sh

echo ""
echo "ğŸ” Running pre-commit validation checks..."
echo ""

# Run markdown linter (shows warnings, doesn't block commit)
echo "ğŸ“ Checking markdown files..."
npm run lint:quiet || true

# Run JavaScript unit tests (must pass to commit)
echo "ğŸ§ª Running unit tests..."
npm test
TEST_EXIT=$?

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Check test results (only tests are blocking)
if [ $TEST_EXIT -ne 0 ]; then
    echo ""
    echo "âŒ Unit tests failed - commit blocked!"
    echo ""
    echo "  â€¢ Fix failing tests above"
    echo ""
    echo "ğŸ’¡ Tip: Use 'git commit --no-verify' to bypass (not recommended)"
    echo ""
    exit 1
else
    echo ""
    echo "âœ… Pre-commit checks passed!"
    echo ""
    echo "ğŸ“ Tip: Run 'npm run lint:fix' to auto-fix any linting issues"
    echo ""
    exit 0
fi
